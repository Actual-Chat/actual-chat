@using ActualChat.UI.Blazor.Services
@inherits ComputedStateComponent<RenderIntoSlot?>

@State.Value?.ChildContent

@code {
    [Inject] private RenderVars RenderVars { get; init; } = null!;

    [Parameter, EditorRequired] public string Name { get; set; } = "";

    protected override ComputedState<RenderIntoSlot?>.Options GetStateOptions()
        => new () {
            UpdateDelayer = FixedDelayer.Instant,
            Category = GetStateCategory(),
        };

    protected override async Task<RenderIntoSlot?> ComputeState(CancellationToken cancellationToken) {
        var slots = await RenderVars.RenderSlot(Name).Use(cancellationToken);
        return slots.LastOrDefault();
    }
}
