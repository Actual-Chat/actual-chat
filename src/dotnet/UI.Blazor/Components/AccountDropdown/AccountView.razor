@namespace ActualChat.UI.Blazor.Components
@using ActualChat.Users
@inherits ComputedStateComponent<ActualChat.Users.AccountFull>
@{
    var account = State.Value;
    if (account == AccountFull.Loading)
        return;
}

<AccountBadge
    UserSid="@account.Id"
    ShowPresence="true"
    NameClass="hidden" />

@code {
    [Inject] Session Session { get; init; } = null!;
    [Inject] IAccounts Accounts { get; init; } = null!;

    protected override ComputedState<AccountFull>.Options GetStateOptions()
        => new() {
            InitialValue = AccountFull.Loading,
            Category = GetStateCategory(),
        };

    protected override Task<AccountFull> ComputeState(CancellationToken cancellationToken)
        => Accounts.GetOwn(Session, cancellationToken);
}
