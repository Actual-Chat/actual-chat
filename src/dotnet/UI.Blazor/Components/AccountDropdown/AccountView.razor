@namespace ActualChat.UI.Blazor.Components
@using ActualChat.Users
@inherits ComputedStateComponent<ActualChat.Users.Account?>
@{
    var account = State.LatestNonErrorValue;
}

<UserAuthorBadge
    UserId="@(account?.Id ?? "")"
    Size="SquareSize.Size12"
    ShowPresence="true"
    TextClass="hidden" />

@code {
    [Inject] Session Session { get; init; } = null!;
    [Inject] IAccounts Accounts { get; init; } = null!;

    protected override ComputedState<Account?>.Options GetStateOptions()
        => new() { UpdateDelayer = FixedDelayer.Instant };

    protected override Task<Account?> ComputeState(CancellationToken cancellationToken)
        => Accounts.Get(Session, cancellationToken);
}
