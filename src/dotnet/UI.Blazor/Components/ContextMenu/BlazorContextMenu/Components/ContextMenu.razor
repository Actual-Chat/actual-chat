@inherits ContextMenuBase
@namespace BlazorContextMenu

@{
    double.TryParse(X, out var x);
    var style = x < 0
        ? $"right:{-x}px;top:{Y}px;z-index:{ZIndex};"
        : $"left:{X}px;top:{Y}px;z-index:{ZIndex};";
}

<div @attributes="@Attributes" class="@($"{BaseClass} {ClassCalc} {DisplayClassCalc}")" id="@Id" style="@style" data-autohide="@AutoHide.ToString().ToLower()" data-autohideevent="@AutoHideEvent.ToString().ToLower()">
    @if (IsShown) {
        <ul class="@ListClassCalc">
            <CascadingValue Value="@((MenuTreeComponent)this)" Name="ParentComponent">
                <CascadingValue Value="@(Template ?? CascadingTemplate)" Name="CascadingTemplate">
                    <CascadingValue Value="@(Animation ?? CascadingAnimation)" Name="CascadingAnimation">
                        @{
                            var context = new MenuRenderingContext(Id, TargetId, X, Y, Trigger, Data);
                            @ChildContent(context)
                        }
                    </CascadingValue>
                </CascadingValue>
            </CascadingValue>
        </ul>
    }
</div>

@code{
    [Parameter]
    public RenderFragment<MenuRenderingContext> ChildContent { get; set; } = null!;
}
