@page "/test/virtual-list"
@using ActualChat.Comparison
@implements IVirtualListDataSource<TestListItemRef>
@inject VirtualListTestService Service
@inject ILogger<VirtualListTestPage> Log
@layout ChatLayout

<RenderIntoSlot Name="MainHeader">
    <MainHeader>VirtualList Test Page</MainHeader>
</RenderIntoSlot>


<VirtualList
    SpacerSize="10_000"
    SkeletonCount="2"
    DataSource="this" KeyComparer="LongAsStringKeyComparer.Default">
    <Item>
        <TestListItemBadge ItemRef="@context" />
    </Item>
    <Skeleton>
        <div>
            Skeleton @(context)...
        </div>
    </Skeleton>
</VirtualList>

<RenderIntoSlot Name="MainFooter">
   <div class="m-3 pl-4">
       <p>URL parameters:</p>
       <ul class="list-disc">
           <li><b>RangeSeed:</b> @RangeSeed</li>
           <li><b>ContentSeed:</b> @ContentSeed</li>
       </ul>

   </div>
</RenderIntoSlot>



@code {
    [Parameter, SupplyParameterFromQuery]
    public int? RangeSeed { get; set; } = null;
    [Parameter, SupplyParameterFromQuery]
    public int? ContentSeed { get; set; } = null;

    public Task<VirtualListData<TestListItemRef>> GetData(
        VirtualListDataQuery query,
        VirtualListData<TestListItemRef> oldData,
        CancellationToken cancellationToken)
        => Service.GetItemKeys(query, RangeSeed, ContentSeed, cancellationToken);
}
