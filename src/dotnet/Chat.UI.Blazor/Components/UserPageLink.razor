@inherits ComputedStateComponent<AccountFull>
@{
    var account = State.Value;
    if (ReferenceEquals(account, AccountFull.Loading))
        return;

    var link = Links.User(account.Id).ToDisplayUrl(UrlMapper);
}

<div class="user-page-link flex-x justify-start items-center gap-x-1">
    <div class="flex-none text-02">
        <a href="@link.AbsoluteUrl">@link.ShortAbsoluteUrl</a>
    </div>
    <CopyToClipboard Class="flex-none text-03" InputClass="hidden" CopyText="@link.AbsoluteUrl"/>
</div>

@code {
    [Inject] private AccountUI AccountUI { get; init; } = null!;
    [Inject] private UrlMapper UrlMapper { get; init; } = null!;

    protected override ComputedState<AccountFull>.Options GetStateOptions()
        => new() {
            InitialValue = AccountUI.OwnAccount.Value,
            Category = GetStateCategory(),
        };

    protected override async Task<AccountFull> ComputeState(CancellationToken cancellationToken)
        => await AccountUI.OwnAccount.Use(cancellationToken);
}
