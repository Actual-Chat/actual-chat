@inherits ComputedStateComponent<User>
@{
    var user = State.LatestNonErrorValue;
    if (!user.IsAuthenticated)
        return;
    var url = Nav.ToAbsoluteUri("/u/" + user.Id).ToString();
}
<div class="user-page-link flex-x justify-start items-center gap-x-1">
    <div class="flex-none text-primary">
        <a href="@url">@url</a>
    </div>
    <CopyToClipboard Class="flex-none text-secondary" InputClass="hidden" Text="@url"/>
</div>

@code {
    [Inject] public Session Session { get; init; } = null!;
    [Inject] public IAuth Auth { get; init; } = null!;
    [Inject] private NavigationManager Nav { get; init; } = null!;

    protected override ComputedState<User>.Options GetStateOptions()
        => new() {
            UpdateDelayer = UpdateDelayer.MinDelay,
            InitialValue = new User(String.Empty, "")
        };

    protected override Task<User> ComputeState(CancellationToken cancellationToken)
        => Auth.GetUser(Session, default);
}
