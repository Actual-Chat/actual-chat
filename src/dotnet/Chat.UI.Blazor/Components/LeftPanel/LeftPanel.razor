@namespace ActualChat.Chat.UI.Blazor.Components
@using ActualChat.UI.Blazor.Components.SideNav
@implements IDisposable

<SideNav
    Side="SideNavSide.Left"
    IsOpen="@PanelsUI.Left.IsVisible.Value"
    VisibilityChanged="@(isOpen => PanelsUI.Left.SetIsVisible(isOpen))">
    <div class="flex-x h-full bg-04">
        <LeftPanelButtons/>
        <LeftPanelContent/>
    </div>
</SideNav>

@code {
    [Inject] private PanelsUI PanelsUI { get; init; } = null!;

    protected override void OnInitialized()
        => PanelsUI.Left.VisibilityChanged += OnNavbarVisibilityChanged;

    public void Dispose()
        => PanelsUI.Left.VisibilityChanged -= OnNavbarVisibilityChanged;

    private void OnNavbarVisibilityChanged(object? sender, EventArgs e)
        => InvokeAsync(StateHasChanged);
}
