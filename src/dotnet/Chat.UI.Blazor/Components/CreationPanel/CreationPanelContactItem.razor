@namespace ActualChat.Chat.UI.Blazor.Components
@using ActualChat.Contacts
@inherits FusionComponentBase
@{
    var url = Links.ChatPage(Contact.Id.ChatId);
    var isFocusable = PageNumber == 1;
    var isSelectable = PageNumber == 2;

    RenderFragment RenderContact()
        => @<div class="creation-panel-contact-item @(isFocusable ? "" : "unfocusable")">
               <div class="flex-x w-full items-center gap-x-2">
                   <AccountCircle UserSid="@Contact.Account!.Id" ShowPresence="true"/>
                   <span class="text-ellipsis whitespace-nowrap overflow-hidden">
                       <SearchUIHighlighter Text="@Contact.Account.Avatar.Name"/>
                   </span>
               </div>
               @if (isSelectable) {
                   <div class="flex-x justify-center min-w-4">
                       <Checkbox
                           Id="@($"creation-panel-contact-{Contact.Account.Id}")"
                           Checked="@IsSelected"
                           Change="@OnSelect"/>
                   </div>
               }
           </div>;
}

@if (DisableLink) {
    <div>
        @RenderContact()
    </div>
} else {
    <a class="unfocusable cursor-pointer" data-href="@url">
        @RenderContact()
    </a>
}

@code {
    [Inject] private ChatUI ChatUI { get; init; } = null!;

    [Parameter, EditorRequired] public Contact Contact { get; set; } = null!;
    [Parameter] public int PageNumber { get; set; }
    [Parameter] public bool DisableLink { get; set; }
    [Parameter] public bool IsSelected { get; set; }
    [Parameter] public EventCallback OnSelect { get; set; }
}
