@using ActualChat.Hosting
@using ActualChat.UI.Blazor.Services
@using ActualChat.Users
@using ActualChat.Chat.UI.Blazor.Components.NewChat
@namespace ActualChat.Chat.UI.Blazor.Components
@inherits OwnAccountComponentBase
@{
    var m = State.Value;
}

<NavbarButton
    Tooltip="Create"
    Click="OnCreateChatClick">
    <i class="icon-plus text-2xl font-medium"></i>
</NavbarButton>

<ChatsNavbarButton/>

@if (m.IsAdmin) {
    <NavbarGroupSelectionButton
        Title="Administration"
        Id="@NavbarGroupIds.Administration"
        Tooltip="Administration">
        <i class="icon-adminx-1 text-2xl font-medium"></i>
    </NavbarGroupSelectionButton>
}
@if (HostInfo.IsDevelopmentInstance) {
    <NavbarGroupSelectionButton
        Title="Test Pages"
        Id="@NavbarGroupIds.TestPages"
        Tooltip="Test Pages">
        <i class="icon-alert-triangle text-2xl font-medium"></i>
    </NavbarGroupSelectionButton>
}

<NavbarButton
    Class="mt-auto"
    Tooltip="Restart"
    Click="OnRestartClick">
    @* <i class="icon-eye-off text-2xl font-medium"></i> *@
    <svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M17.303 10.426C16.777 10.259 16.215 10.55 16.047 11.076C15.11 14.022 12.352 16 9.184 16C5.222 16 2 12.86 2 9C2 5.141 5.222 2 9.184 2C10.912 2 12.542 2.602 13.829 3.67L11.663 3.313C11.113 3.213 10.603 3.592 10.513 4.136C10.423 4.681 10.792 5.196 11.337 5.285L15.583 5.987C15.638 5.996 15.694 6 15.747 6C15.866 6 15.982 5.979 16.09 5.939C16.127 5.925 16.157 5.899 16.193 5.88C16.259 5.846 16.328 5.816 16.385 5.768C16.421 5.739 16.444 5.697 16.475 5.663C16.522 5.614 16.572 5.567 16.607 5.507C16.632 5.464 16.642 5.413 16.661 5.365C16.685 5.306 16.717 5.251 16.729 5.186L17.483 1.186C17.585 0.643 17.228 0.119 16.685 0.018C16.144 -0.08 15.619 0.273 15.517 0.815L15.245 2.256C13.581 0.815 11.448 0 9.184 0C4.12 0 0 4.037 0 9C0 13.963 4.12 18 9.184 18C13.226 18 16.75 15.461 17.953 11.682C18.12 11.156 17.829 10.594 17.303 10.426Z" />
    </svg>
</NavbarButton>

@code {
    [Inject] private ModalUI ModalUI { get; init; } = null!;
    [Inject] private IRestartService RestartService { get; init; } = null!;

    private Task OnCreateChatClick()
        => ModalUI.Show(new NewChatModal.Model());

    private void OnRestartClick()
        => RestartService.Restart();
}
