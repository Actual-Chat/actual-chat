@namespace ActualChat.Chat.UI.Blazor.Components
@using Stl.Rpc
@inherits FusionComponentBase

<SearchPanel
    @ref="_searchPanelRef"
    Class="right-panel-search"
    ShowCloseButton="@true"
    OnCloseClick="@CloseSearchPanel">
    <RightPanelSearchTabs ChatContext="@ChatContext"/>
</SearchPanel>

@code {
    private SearchPanel? _searchPanelRef;

    [Parameter, EditorRequired] public ChatContext ChatContext { get; set; } = null!;

    protected override async Task OnAfterRenderAsync(bool firstRender) {
        if (_searchPanelRef != null)
            await _searchPanelRef.Focus();
    }

    private void CloseSearchPanel()
        => ChatContext.Hub.ChatUI.EnableSearch(ChatId.None);
}
